<!DOCTYPE html>
<html>
<head>
  <title>üéµ SoundCloud Downloader</title>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: sans-serif;
      padding: 50px;
      max-width: 600px;
      margin: auto;
      background: #f7f7f7;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      margin-top: 10px;
    }
    #result {
      margin-top: 20px;
    }
    .track {
      background: white;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h2>üéß SoundCloud Track & Playlist Downloader</h2>
  <form id="fetchForm">
    <input type="text" id="urlInput" name="url" placeholder="Enter SoundCloud track or playlist URL" required>
    <button type="submit">Fetch</button>
  </form>

  <div id="result"></div>

  <script>
    document.getElementById("fetchForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const url = document.getElementById("urlInput").value;
      const formData = new FormData();
      formData.append("url", url);

      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "Fetching info...";

      const res = await fetch("/fetch", {
        method: "POST",
        body: formData
      });

      const data = await res.json();
      resultDiv.innerHTML = "";

      if (data.error) {
        resultDiv.innerHTML = `<p style="color:red;">‚ùå ${data.error}</p>`;
        return;
      }

      if (data.type === "playlist") {
        resultDiv.innerHTML = `<h3>${data.title}</h3>`;
        data.tracks.forEach(track => {
          const div = document.createElement("div");
          div.className = "track";
          div.innerHTML = `
            <p>${track.title}</p>
            <a href="/stream?url=${encodeURIComponent(track.url)}" download>
              <button>‚¨á Download</button>
            </a>`;
          resultDiv.appendChild(div);
        });
      } else {
        resultDiv.innerHTML = `
          <p><strong>${data.title}</strong></p>
          <a href="/stream?url=${encodeURIComponent(data.url)}" download>
            <button>‚¨á Download</button>
          </a>`;
      }
    });
  </script>
</body>
</html>
